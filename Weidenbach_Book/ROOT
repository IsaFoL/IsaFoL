chapter Weidenbach_Book

session "Weidenbach_Book_Base" (Weidenbach_Book) = "Sepref_IICF" +
  description \<open>This session imports HOL, some additional useful theories from HOL, and our own
  extensions above these lemmas.\<close>
  options [document = pdf, document_output = "output"]
  sessions
    "HOL-Eisbach"
    "HOL-Library"
    Nested_Multisets_Ordinals
  theories [document = false]
    "HOL-Library.Code_Target_Numeral"
    "HOL-Library.Multiset"
    "HOL-Library.Multiset_Order"
    "HOL-Library.Extended_Nat"
    Nested_Multisets_Ordinals.Multiset_More
    "HOL-Eisbach.Eisbach"
    "HOL-Eisbach.Eisbach_Tools"
  theories
    Doc_Libraries
    Wellfounded_More
    WB_List_More
    "../lib/Explorer"
  document_files
    "root.tex"
    "biblio.bib"

session "Entailment_Definition" (Weidenbach_Book) = "Weidenbach_Book_Base" +
  description \<open>This session contains various (but still general) definition of entailment used
  later.\<close>
  options [document = pdf, document_output = "output"]
  sessions
    "HOL-Library"
    Ordered_Resolution_Prover
  theories [document = true]
    Doc_Entailment
    Partial_Clausal_Logic
    Partial_Annotated_Clausal_Logic
    Prop_Logic
  document_files
    "root.tex"
    "biblio.bib"

session "Normalisation" (Weidenbach_Book) = "Entailment_Definition" +
  description \<open>This session contains the normalisation from general formulas to CNF and DNF.\<close>
  options [document = pdf, document_output = "output"]
  sessions
    Nested_Multisets_Ordinals
    Entailment_Definition
  theories [document = false]
    Nested_Multisets_Ordinals.Multiset_More
  theories [document = true]
    Prop_Abstract_Transformation
    Prop_Normalisation
    Prop_Logic_Multiset
  document_files
    "root.tex"
    "biblio.bib"

session "Resolution_Superposition" (Weidenbach_Book) = "Entailment_Definition" +
  description \<open>This session contains the formalisation of resolution and the beginning of
  superposition.\<close>
  options [document = pdf, document_output = "output"]
  theories [document = true]
    Prop_Logic
    Prop_Abstract_Transformation
    Prop_Normalisation
    Prop_Logic_Multiset
    Prop_Resolution
  theories [quick_and_dirty, document = true]
    Prop_Superposition
  document_files
    "root.tex"
    "biblio.bib"

session "CDCL_no_Sepref" (Weidenbach_Book) = "HOL"  +
  description \<open>This session is the same as the CDCL session, but des not import
  the Refinement Framework.
  \<close>
  options [document = pdf, document = false]
  sessions
    Nested_Multisets_Ordinals
    Weidenbach_Book_Base
    Entailment_Definition
    Ordered_Resolution_Prover
  theories [quick_and_dirty = false]
    DPLL_W
    CDCL_W_Level
    CDCL_W
    CDCL_W_Termination
    CDCL_W_Merge
    CDCL_NOT
    CDCL_WNOT
    CDCL_W_Full
    CDCL_W_Restart
    CDCL_W_Incremental
    CDCL_W_Optimal_Model

    DPLL_CDCL_W_Implementation
    DPLL_W_Implementation
    CDCL_W_Implementation
    CDCL_Abstract_Clause_Representation
    CDCL_W_Abstract_State

  document_files
    "root.tex"
    "biblio.bib"

session "CDCL" (Weidenbach_Book) = "Sepref_IICF"  +
  description \<open>This session the CDCL calculi (Weidenbach and Nieuwenhuis et al.) and the links between
  both. It also contains a very simple implementation based on lists and two extensions (restart and
  incremental).

  This version is based on the Refinement Framework, to make the two-watched-literals part easier to compile
  (workaround as long as a session cannot have two parents).
  \<close>
  options [document = pdf, document_output = "output"]
  sessions
    Nested_Multisets_Ordinals
    Weidenbach_Book_Base
    Entailment_Definition
  theories [document = false]
    "HOL-Eisbach.Eisbach_Tools"

  theories [quick_and_dirty = false, document = true]
    DPLL_W
    CDCL_W_Level
    CDCL_W
    CDCL_W_Termination
    CDCL_W_Merge
    CDCL_NOT
    CDCL_WNOT
    CDCL_W_Full
    CDCL_W_Restart
    CDCL_W_Incremental
    CDCL_W_Optimal_Model

    DPLL_CDCL_W_Implementation
    DPLL_W_Implementation
    CDCL_W_Implementation
    CDCL_Abstract_Clause_Representation
    CDCL_W_Abstract_State

  document_files
    "root.tex"
    "biblio.bib"

session "Watched_Literals" (Weidenbach_Book) = "CDCL"  +
  description \<open>This session contains all theories related to the two-watched literals. It linls
    the abstract CDCL calculus to a more concrete version with watched literals.\<close>
  options [document = pdf, document_output = "output"]
  sessions
    CDCL
    "HOL-Eisbach"
  theories [quick_and_dirty = false, document = true]
    Bits_Natural
    Array_UInt
    WB_Word_Assn
    WB_More_Refinement
    Watched_Literals_Algorithm
    Watched_Literals_List
    Watched_Literals_Watch_List
    Watched_Literals_Watch_List_Domain
    Watched_Literals_Watch_List_Initialisation
    Watched_Literals_Watch_List_Code_Common

(* Restarts not clear if different session of not 
    Watched_Literals_Transition_System_Restart
    Watched_Literals_Algorithm_Restart
    Watched_Literals_List_Restart
    Watched_Literals_Watch_List_Restart
    Watched_Literals_Watch_List_Domain_Restart*)
    
  document_files
    "root.tex"
    "biblio.bib"

session "IsaSAT" (Weidenbach_Book) = "Watched_Literals"  +
  description \<open>We here refine the previous session to generate code.\<close>
  sessions
    CDCL
    "HOL-Eisbach"
    Watched_Literals
  theories
    (*Watched_Literals_Transition_System_Restart*)
    CDCL_Conflict_Minimisation
    Watched_Literals_VMTF
    LBD
    IsaSAT_Setup
    IsaSAT_CDCL
    IsaSAT_Backtrack
    IsaSAT_Initialisation
    IsaSAT_Propagate_Conflict
    IsaSAT_Decide
    IsaSAT

  document_files
    "root.tex"
    "biblio.bib"


session Model_Enumeration (Weidenbach_Book) = Watched_Literals +
  description \<open>This extends the previous version to a very simple 'SMT' solver: we enumerate all models and let an unspecified theoty solver checks if a model is valid or another must be found.\<close>
  sessions
    Normalisation
    Resolution_Superposition
    CDCL
    Watched_Literals
  theories[document = true]
    Model_Enumeration
    Watched_Literals_Transition_System_Enumeration
    Watched_Literals_Algorithm_Enumeration
    Watched_Literals_List_Enumeration
  document_files
    "root.tex"
    "biblio.bib"

session Weidenbach_Book (Weidenbach_Book) = IsaSAT +
  description \<open>We import everything\<close>
  sessions
    Normalisation
    Resolution_Superposition
    CDCL
    Watched_Literals
    Model_Enumeration
    IsaSAT
  theories[document = true, quick_and_dirty]
    Weidenbach_Book
  document_files
    "root.tex"
    "biblio.bib"